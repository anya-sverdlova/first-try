<!DOCTYPE HTML>
<html>
<head>
<title>Template</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="css/stylesheet_testwork.css">
<script type="text/javascript" src="js/lib/ann.js"></script>
<script>
	window.onload = (function(){
  var cache = {};
  
  this.tmpl = function tmpl(str, data){
    var fn = !/\W/.test(str) ?
      cache[str] = cache[str] ||
        tmpl(document.getElementById(str).innerHTML) :
      
      new Function("obj",
        "var p=[],print=function(){p.push.apply(p,arguments);};" +             
        "with(obj){p.push('" +

        str
          .replace(/[\r\t\n]/g, " ")
          .split("<%").join("\t")
          .replace(/((^|%>)[^\t]*)'/g, "$1\r")
          .replace(/\t=(.*?)%>/g, "',$1,'")
          .split("\t").join("');")
          .split("%>").join("p.push('")
          .split("\r").join("\\'")
      + "');}return p.join('');");

    return data ? fn( data ) : fn;
  };
})();
</script>
<script type="text/template" id="result">		
			<%  for (var i = 0; i < count ; i++) {
				var textBlock = document.createElement('div');
				textBlock.className = 'text_block';												
				var innerLeft = document.createElement('div');
				innerLeft.innerHTML = myName;
				innerLeft.className = 'inner_left';
				textBlock.appendChild(innerLeft);
				var innerRight = document.createElement('div');					
				innerRight.className = 'inner_right';
				innerRight.innerHTML = myButton;
				textBlock.appendChild(innerRight);				
				myElement.appendChild(textBlock);
				}
			%>				
	</div>	
</script>

</head>
<body>
<div id="cover">		
	<div class="page_title">Page title</div>
	<div class="settings">Settings</div>
	<div class="close">x</div>
	<div id="cleaner"></div>
	<div class="rating">Rating:</div>
	<div class="stars"><img src="media/star.png"><img src="media/star.png"><img src="media/star.png"><img src="media/star.png"><img src="media/star.png"></div>
	<div id="cleaner"></div>
	<div class="reviews">Reviews</div>
	<div class="add_rev">Add reviews</div>
	<hr noshade class="blue_line">
	<div id="wrapper">
		
	</div>
</div>
<script>
	var data = { count: 3, myName: 'anna', myElement: ann('#wrapper').domElements, myButton: '<button onclick="getText();">Comment</button>' };
	var smth = tmpl('result', data);
</script>
<script>
	function getText() { 
	ann('.inner_left').load('https://api.mongolab.com/api/1/databases/first-base/collections/reviews?apiKey=fUlPVExWjzXy1yjlMzvqzi1oREPQwkwQ'); 	
	}
</script>
</body>
</html>